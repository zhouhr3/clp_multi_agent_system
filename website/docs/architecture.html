<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>系统架构 - 唇腭裂多智能体系统</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/styles.css" rel="stylesheet">
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top">
        <div class="container">
            <a class="navbar-brand" href="../index.html">唇腭裂多智能体系统</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html">首页</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html#features">功能特点</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html#architecture">系统架构</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html#agents">智能体介绍</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="../index.html#docs">文档</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html#contact">联系我们</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- 文档内容 -->
    <div class="container my-5">
        <div class="row">
            <div class="col-lg-3">
                <div class="doc-sidebar">
                    <h5 class="mb-3">目录</h5>
                    <nav class="nav flex-column">
                        <a class="nav-link" href="#overview">1. 系统概述</a>
                        <a class="nav-link" href="#architecture">2. 系统架构</a>
                        <a class="nav-link" href="#components">3. 组件详细说明</a>
                        <a class="nav-link" href="#data-flow">4. 数据流</a>
                        <a class="nav-link" href="#tech-stack">5. 技术栈</a>
                        <a class="nav-link" href="#extensibility">6. 扩展性设计</a>
                        <a class="nav-link" href="#security">7. 安全性考虑</a>
                        <a class="nav-link" href="#limitations">8. 限制和约束</a>
                        <a class="nav-link" href="#future">9. 未来发展方向</a>
                    </nav>
                </div>
            </div>
            <div class="col-lg-9">
                <div class="doc-content">
                    <h1 class="mb-4">唇腭裂多智能体系统架构文档</h1>
                    
                    <section id="overview">
                        <h2>1. 系统概述</h2>
                        <p>唇腭裂多智能体系统是一个基于人工智能的医疗辅助决策系统，专门用于唇腭裂患者的诊断和治疗建议。系统采用多智能体架构，集成了多个专科智能体，能够根据患者症状和特征，动态招募相关专科智能体，提供综合的诊断和治疗建议。</p>
                        
                        <p>系统主要功能包括：</p>
                        <ul>
                            <li>区分综合征性和非综合征性唇腭裂</li>
                            <li>分析唇腭裂类型和严重程度</li>
                            <li>提供个性化治疗方案建议</li>
                            <li>协调多学科专家意见</li>
                            <li>集成外部医学知识库和文献资源</li>
                        </ul>
                    </section>
                    
                    <section id="architecture" class="mt-5">
                        <h2>2. 系统架构</h2>
                        <p>系统采用分层架构，主要包括以下几个层次：</p>
                        
                        <h3 class="h4 mt-4">2.1 核心层</h3>
                        <p>核心层包含系统的基础组件和框架：</p>
                        <ul>
                            <li><strong>Agent基类</strong>：所有智能体的基础类，定义了智能体的通用属性和方法</li>
                            <li><strong>AgentManager</strong>：负责智能体的招募、激活和协调</li>
                            <li><strong>KnowledgeBase</strong>：提供医学知识支持</li>
                            <li><strong>APIIntegration</strong>：与外部医学数据库和服务集成</li>
                        </ul>
                        
                        <h3 class="h4 mt-4">2.2 智能体层</h3>
                        <p>智能体层包含各个专科智能体：</p>
                        <ul>
                            <li><strong>CleftLipPalateAgent</strong>：唇腭裂专科智能体，负责分析唇腭裂类型，提供非综合征性唇腭裂的治疗建议</li>
                            <li><strong>CraniofacialAgent</strong>：颅面外科智能体，负责分析颅面畸形，提供相关治疗方案</li>
                            <li><strong>GeneticAgent</strong>：遗传学智能体，负责判断遗传异常，提供遗传检测建议</li>
                            <li><strong>OtologyAgent</strong>：外耳智能体，负责分析耳部异常，提供耳科治疗建议</li>
                            <li><strong>OphthalmologyAgent</strong>：眼科智能体，负责分析眼部异常，提供眼科治疗建议</li>
                        </ul>
                        
                        <h3 class="h4 mt-4">2.3 应用层</h3>
                        <p>应用层提供系统的对外接口和用户界面：</p>
                        <ul>
                            <li><strong>CLPAgentSystem</strong>：系统主类，集成所有组件并提供统一接口</li>
                            <li><strong>用户界面</strong>：基于Gradio的Web界面，用于与系统交互</li>
                        </ul>
                        
                        <h3 class="h4 mt-4">2.4 架构图</h3>
                        <div class="bg-light p-3 rounded my-3">
                            <pre>
+----------------------------------+
|           应用层                  |
|  +----------------------------+  |
|  |      CLPAgentSystem       |  |
|  +----------------------------+  |
|  |         用户界面           |  |
|  +----------------------------+  |
+----------------------------------+
              |
+----------------------------------+
|           智能体层                |
|  +----------------------------+  |
|  |    CleftLipPalateAgent    |  |
|  +----------------------------+  |
|  |    CraniofacialAgent      |  |
|  +----------------------------+  |
|  |      GeneticAgent         |  |
|  +----------------------------+  |
|  |      OtologyAgent         |  |
|  +----------------------------+  |
|  |    OphthalmologyAgent     |  |
|  +----------------------------+  |
+----------------------------------+
              |
+----------------------------------+
|            核心层                 |
|  +----------------------------+  |
|  |         Agent基类          |  |
|  +----------------------------+  |
|  |      AgentManager         |  |
|  +----------------------------+  |
|  |      KnowledgeBase        |  |
|  +----------------------------+  |
|  |      APIIntegration       |  |
|  +----------------------------+  |
+----------------------------------+
                            </pre>
                        </div>
                    </section>
                    
                    <section id="components" class="mt-5">
                        <h2>3. 组件详细说明</h2>
                        
                        <h3 class="h4 mt-4">3.1 Agent基类</h3>
                        <p>Agent基类定义了所有智能体的通用属性和方法，包括：</p>
                        <ul>
                            <li>角色和专业领域定义</li>
                            <li>消息历史管理</li>
                            <li>激活条件管理</li>
                            <li>与语言模型API的交互</li>
                        </ul>
                        
                        <div class="bg-light p-3 rounded my-3">
                            <pre>
class Agent:
    def __init__(self, role, expertise, description, model_info, temperature, api_key):
        # 初始化智能体属性
        
    def add_message(self, role, content):
        # 添加消息到历史
        
    def add_activation_condition(self, condition):
        # 添加激活条件
        
    def check_activation(self, context):
        # 检查是否应该激活智能体
        
    async def _call_llm_api(self):
        # 调用语言模型API
                            </pre>
                        </div>
                        
                        <h3 class="h4 mt-4">3.2 AgentManager</h3>
                        <p>AgentManager负责智能体的招募、激活和协调，包括：</p>
                        <ul>
                            <li>智能体注册和管理</li>
                            <li>根据上下文招募智能体</li>
                            <li>协调多个智能体进行分析</li>
                            <li>整合各智能体的分析结果</li>
                        </ul>
                        
                        <div class="bg-light p-3 rounded my-3">
                            <pre>
class AgentManager:
    def __init__(self):
        # 初始化智能体管理器
        
    def register_agent(self, agent_id, agent):
        # 注册智能体
        
    async def recruit_agents(self, context):
        # 根据上下文招募智能体
        
    async def coordinate_analysis(self, query):
        # 协调智能体进行分析
        
    def _integrate_results(self, results):
        # 整合分析结果
                            </pre>
                        </div>
                        
                        <h3 class="h4 mt-4">3.3 KnowledgeBase</h3>
                        <p>KnowledgeBase提供医学知识支持，包括：</p>
                        <ul>
                            <li>唇腭裂相关综合征信息</li>
                            <li>治疗指南和最佳实践</li>
                            <li>医学术语和定义</li>
                            <li>症状与疾病的关联</li>
                        </ul>
                        
                        <div class="bg-light p-3 rounded my-3">
                            <pre>
class KnowledgeBase:
    def __init__(self):
        # 初始化知识库
        
    def search_syndromes(self, symptoms):
        # 根据症状搜索可能的综合征
        
    def get_treatment_guideline(self, condition_id):
        # 获取治疗指南
        
    def get_medical_term_definition(self, term):
        # 获取医学术语定义
                            </pre>
                        </div>
                        
                        <h3 class="h4 mt-4">3.4 APIIntegration</h3>
                        <p>APIIntegration与外部医学数据库和服务集成，包括：</p>
                        <ul>
                            <li>PubMed文献搜索</li>
                            <li>MedGen遗传信息查询</li>
                            <li>ClinVar变异数据查询</li>
                        </ul>
                        
                        <div class="bg-light p-3 rounded my-3">
                            <pre>
class APIIntegration:
    def __init__(self, api_keys):
        # 初始化API集成
        
    async def search_literature(self, query, max_results):
        # 搜索医学文献
        
    async def query_genetic_info(self, gene_id):
        # 查询遗传信息
        
    async def query_variant_data(self, variant_id):
        # 查询变异数据
                            </pre>
                        </div>
                        
                        <h3 class="h4 mt-4">3.5 CLPAgentSystem</h3>
                        <p>CLPAgentSystem是系统主类，集成所有组件并提供统一接口，包括：</p>
                        <ul>
                            <li>系统初始化和配置</li>
                            <li>患者数据分析</li>
                            <li>治疗指南获取</li>
                            <li>医学文献搜索</li>
                        </ul>
                        
                        <div class="bg-light p-3 rounded my-3">
                            <pre>
class CLPAgentSystem:
    def __init__(self, api_keys=None):
        # 初始化系统
        
    async def initialize(self):
        # 初始化系统组件
        
    async def analyze_patient(self, patient_data):
        # 分析患者数据
        
    async def get_treatment_guidelines(self, condition_id):
        # 获取治疗指南
        
    async def search_medical_literature(self, query, max_results):
        # 搜索医学文献
                            </pre>
                        </div>
                    </section>
                    
                    <section id="data-flow" class="mt-5">
                        <h2>4. 数据流</h2>
                        <p>系统的主要数据流如下：</p>
                        <ol>
                            <li><strong>患者数据输入</strong>：用户通过界面输入患者基本信息、症状和病史</li>
                            <li><strong>综合征判断</strong>：系统使用知识库判断是否为综合征性唇腭裂</li>
                            <li><strong>智能体招募</strong>：AgentManager根据患者特征招募相关专科智能体</li>
                            <li><strong>分布式分析</strong>：各专科智能体并行分析患者数据</li>
                            <li><strong>结果整合</strong>：AgentManager整合各智能体的分析结果</li>
                            <li><strong>外部知识补充</strong>：系统通过APIIntegration补充相关医学文献</li>
                            <li><strong>结果呈现</strong>：系统将最终分析结果呈现给用户</li>
                        </ol>
                    </section>
                    
                    <section id="tech-stack" class="mt-5">
                        <h2>5. 技术栈</h2>
                        <p>系统使用的主要技术包括：</p>
                        <ul>
                            <li><strong>编程语言</strong>：Python 3.10+</li>
                            <li><strong>AI模型</strong>：GPT-4及其变体</li>
                            <li><strong>Web框架</strong>：Gradio</li>
                            <li><strong>异步处理</strong>：asyncio</li>
                            <li><strong>数据处理</strong>：JSON</li>
                            <li><strong>外部API</strong>：PubMed, MedGen, ClinVar</li>
                        </ul>
                    </section>
                    
                    <section id="extensibility" class="mt-5">
                        <h2>6. 扩展性设计</h2>
                        <p>系统设计考虑了以下扩展性因素：</p>
                        <ol>
                            <li><strong>新智能体添加</strong>：只需继承Agent基类并实现特定方法，无需修改核心架构</li>
                            <li><strong>知识库扩展</strong>：知识库支持增量更新和扩展</li>
                            <li><strong>外部API集成</strong>：APIIntegration支持添加新的外部服务</li>
                            <li><strong>用户界面定制</strong>：界面组件可独立于核心系统进行定制和扩展</li>
                        </ol>
                    </section>
                    
                    <section id="security" class="mt-5">
                        <h2>7. 安全性考虑</h2>
                        <p>系统在设计中考虑了以下安全因素：</p>
                        <ol>
                            <li><strong>数据隐私</strong>：患者数据仅在本地处理，不存储敏感信息</li>
                            <li><strong>API密钥管理</strong>：外部API密钥通过安全方式管理</li>
                            <li><strong>输入验证</strong>：所有用户输入经过验证，防止注入攻击</li>
                            <li><strong>结果可解释性</strong>：系统提供分析结果的解释和依据</li>
                        </ol>
                    </section>
                    
                    <section id="limitations" class="mt-5">
                        <h2>8. 限制和约束</h2>
                        <p>系统当前存在以下限制：</p>
                        <ol>
                            <li><strong>离线功能有限</strong>：部分功能依赖外部API和服务</li>
                            <li><strong>语言支持</strong>：当前主要支持中文</li>
                            <li><strong>验证状态</strong>：系统尚未经过临床验证，仅作为辅助工具使用</li>
                            <li><strong>计算资源</strong>：多智能体并行分析需要较高的计算资源</li>
                        </ol>
                    </section>
                    
                    <section id="future" class="mt-5">
                        <h2>9. 未来发展方向</h2>
                        <p>系统未来可能的发展方向包括：</p>
                        <ol>
                            <li><strong>更多专科智能体</strong>：添加更多专科领域的智能体</li>
                            <li><strong>临床验证</strong>：与医疗机构合作进行临床验证</li>
                            <li><strong>多模态输入</strong>：支持图像和语音输入</li>
                            <li><strong>个性化推荐</strong>：基于历史数据提供更个性化的建议</li>
                            <li><strong>多语言支持</strong>：扩展支持更多语言</li>
                        </ol>
                    </section>
                </div>
            </div>
        </div>
    </div>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4 mb-md-0">
                    <h5>唇腭裂多智能体系统</h5>
                    <p>基于人工智能的医疗辅助决策系统，专门用于唇腭裂患者的诊断和治疗建议。</p>
                </div>
                <div class="col-md-4 mb-4 mb-md-0">
                    <h5>快速链接</h5>
                    <ul class="list-unstyled<response clipped><NOTE>To save on context only part of this file has been shown to you. You should retry this tool after you have searched inside the file with `grep -n` in order to find the line numbers of what you are looking for.</NOTE>